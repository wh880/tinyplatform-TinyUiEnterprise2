(function(e){var b=false;var a={asc:"Ascending",desc:"Descending"};var f=function(l){var g=l.$sortModal.selector,k=g.substr(1);if(!e(k).hasClass("modal")){var m='  <div class="modal fade" id="'+k+'" tabindex="-1" role="dialog" aria-labelledby="'+k+'Label" aria-hidden="true">';m+='         <div class="modal-dialog">';m+='             <div class="modal-content">';m+='                 <div class="modal-header">';m+='                     <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';m+='                     <h4 class="modal-title" id="'+k+'Label">'+l.options.formatMultipleSort()+"</h4>";m+="                 </div>";m+='                 <div class="modal-body">';m+='                     <div class="bootstrap-table">';m+='                         <div class="fixed-table-toolbar">';m+='                             <div class="bars">';m+='                                 <div id="toolbar">';m+='                                     <button id="add" type="button" class="btn btn-default"><i class="'+l.options.iconsPrefix+" "+l.options.icons.plus+'"></i> '+l.options.formatAddLevel()+"</button>";m+='                                     <button id="delete" type="button" class="btn btn-default" disabled><i class="'+l.options.iconsPrefix+" "+l.options.icons.minus+'"></i> '+l.options.formatDeleteLevel()+"</button>";m+="                                 </div>";m+="                             </div>";m+="                         </div>";m+='                         <div class="fixed-table-container">';m+='                             <table id="multi-sort" class="table">';m+="                                 <thead>";m+="                                     <tr>";m+="                                         <th></th>";m+='                                         <th><div class="th-inner">'+l.options.formatColumn()+"</div></th>";m+='                                         <th><div class="th-inner">'+l.options.formatOrder()+"</div></th>";m+="                                     </tr>";m+="                                 </thead>";m+="                                 <tbody></tbody>";m+="                             </table>";m+="                         </div>";m+="                     </div>";m+="                 </div>";m+='                 <div class="modal-footer">';m+='                     <button type="button" class="btn btn-default" data-dismiss="modal">'+l.options.formatCancel()+"</button>";m+='                     <button type="button" class="btn btn-primary">'+l.options.formatSort()+"</button>";m+="                 </div>";m+="             </div>";m+="         </div>";m+="     </div>";e("body").append(e(m));l.$sortModal=e(g);var h=l.$sortModal.find("tbody > tr");l.$sortModal.off("click","#add").on("click","#add",function(){var i=l.$sortModal.find(".multi-sort-name:first option").length,n=l.$sortModal.find("tbody tr").length;if(n<i){n++;l.addLevel();l.setButtonStates()}});l.$sortModal.off("click","#delete").on("click","#delete",function(){var i=l.$sortModal.find(".multi-sort-name:first option").length,n=l.$sortModal.find("tbody tr").length;if(n>1&&n<=i){n--;l.$sortModal.find("tbody tr:last").remove();l.setButtonStates()}});l.$sortModal.off("click",".btn-primary").on("click",".btn-primary",function(){var o=l.$sortModal.find("tbody > tr"),r=l.$sortModal.find("div.alert"),n=[],q=[];l.options.sortPriority=e.map(o,function(v){var t=e(v),u=t.find(".multi-sort-name").val(),i=t.find(".multi-sort-order").val();n.push(u);return{sortName:u,sortOrder:i}});var s=n.sort();for(var p=0;p<n.length-1;p++){if(s[p+1]==s[p]){q.push(s[p])}}if(q.length>0){if(r.length===0){r='<div class="alert alert-danger" role="alert"><strong>'+l.options.formatDuplicateAlertTitle()+"</strong> "+l.options.formatDuplicateAlertDescription()+"</div>";e(r).insertBefore(l.$sortModal.find(".bars"))}}else{if(r.length===1){e(r).remove()}l.options.sortName="";l.onMultipleSort();l.$sortModal.modal("hide")}});if(l.options.sortPriority===null||l.options.sortPriority.length===0){if(l.options.sortName){l.options.sortPriority=[{sortName:l.options.sortName,sortOrder:l.options.sortOrder}]}}if(l.options.sortPriority!==null&&l.options.sortPriority.length>0){if(h.length<l.options.sortPriority.length&&typeof l.options.sortPriority==="object"){for(var j=0;j<l.options.sortPriority.length;j++){l.addLevel(j,l.options.sortPriority[j])}}}else{l.addLevel(0)}l.setButtonStates()}};e.extend(e.fn.bootstrapTable.defaults,{showMultiSort:false,sortPriority:null,onMultipleSort:function(){return false}});e.extend(e.fn.bootstrapTable.defaults.icons,{sort:"glyphicon-sort",plus:"glyphicon-plus",minus:"glyphicon-minus"});e.extend(e.fn.bootstrapTable.Constructor.EVENTS,{"multiple-sort.bs.table":"onMultipleSort"});e.extend(e.fn.bootstrapTable.locales,{formatMultipleSort:function(){return"Multiple Sort"},formatAddLevel:function(){return"Add Level"},formatDeleteLevel:function(){return"Delete Level"},formatColumn:function(){return"Column"},formatOrder:function(){return"Order"},formatSortBy:function(){return"Sort by"},formatThenBy:function(){return"Then by"},formatSort:function(){return"Sort"},formatCancel:function(){return"Cancel"},formatDuplicateAlertTitle:function(){return"Duplicate(s) detected!"},formatDuplicateAlertDescription:function(){return"Please remove or change any duplicate column."}});e.extend(e.fn.bootstrapTable.defaults,e.fn.bootstrapTable.locales);var c=e.fn.bootstrapTable.Constructor,d=c.prototype.initToolbar;c.prototype.initToolbar=function(){this.showToolbar=true;var h=this,j="#sortModal_"+this.$el.attr("id");this.$sortModal=e(j);d.apply(this,Array.prototype.slice.apply(arguments));if(this.options.showMultiSort){var i=this.$toolbar.find(">.btn-group").first(),g=this.$toolbar.find("div.multi-sort");if(!g.length){g='  <button class="multi-sort btn btn-default'+(this.options.iconSize===undefined?"":" btn-"+this.options.iconSize)+'" type="button" data-toggle="modal" data-target="'+j+'" title="'+this.options.formatMultipleSort()+'">';g+='     <i class="'+this.options.iconsPrefix+" "+this.options.icons.sort+'"></i>';g+="</button>";i.append(g);f(h)}this.$el.on("sort.bs.table",function(){b=true});this.$el.on("multiple-sort.bs.table",function(){b=false});this.$el.on("load-success.bs.table",function(){if(!b&&h.options.sortPriority!==null&&typeof h.options.sortPriority==="object"){h.onMultipleSort()}});this.$el.on("column-switch.bs.table",function(m,l){for(var k=0;k<h.options.sortPriority.length;k++){if(h.options.sortPriority[k].sortName===l){h.options.sortPriority.splice(k,1)}}h.assignSortableArrows();h.$sortModal.remove();f(h)});this.$el.on("reset-view.bs.table",function(){if(!b&&h.options.sortPriority!==null&&typeof h.options.sortPriority==="object"){h.assignSortableArrows()}})}};c.prototype.onMultipleSort=function(){var h=this;var g=function(j,k){return j>k?1:j<k?-1:0};var i=function(l,k){var n=[],m=[];for(var o=0;o<h.options.sortPriority.length;o++){var j=h.options.sortPriority[o].sortOrder==="desc"?-1:1,p=l[h.options.sortPriority[o].sortName],q=k[h.options.sortPriority[o].sortName];if(p===undefined||p===null){p=""}if(q===undefined||q===null){q=""}if(e.isNumeric(p)&&e.isNumeric(q)){p=parseFloat(p);q=parseFloat(q)}if(typeof p!=="string"){p=p.toString()}n.push(j*g(p,q));m.push(j*g(q,p))}return g(n,m)};this.data.sort(function(k,j){return i(k,j)});this.initBody();this.assignSortableArrows();this.trigger("multiple-sort")};c.prototype.addLevel=function(h,i){var k=h===0?this.options.formatSortBy():this.options.formatThenBy();this.$sortModal.find("tbody").append(e("<tr>").append(e("<td>").text(k)).append(e("<td>").append(e('<select class="form-control multi-sort-name">'))).append(e("<td>").append(e('<select class="form-control multi-sort-order">'))));var j=this.$sortModal.find(".multi-sort-name").last(),g=this.$sortModal.find(".multi-sort-order").last();e.each(this.columns,function(l,m){if(m.sortable===false||m.visible===false){return true}j.append('<option value="'+m.field+'">'+m.title+"</option>")});e.each(a,function(m,l){g.append('<option value="'+m+'">'+l+"</option>")});if(i!==undefined){j.find('option[value="'+i.sortName+'"]').attr("selected",true);g.find('option[value="'+i.sortOrder+'"]').attr("selected",true)}};c.prototype.assignSortableArrows=function(){var h=this,j=h.$header.find("th");for(var g=0;g<j.length;g++){for(var k=0;k<h.options.sortPriority.length;k++){if(e(j[g]).data("field")===h.options.sortPriority[k].sortName){e(j[g]).find(".sortable").removeClass("desc asc").addClass(h.options.sortPriority[k].sortOrder)}}}};c.prototype.setButtonStates=function(){var g=this.$sortModal.find(".multi-sort-name:first option").length,h=this.$sortModal.find("tbody tr").length;if(h==g){this.$sortModal.find("#add").attr("disabled","disabled")}if(h>1){this.$sortModal.find("#delete").removeAttr("disabled")}if(h<g){this.$sortModal.find("#add").removeAttr("disabled")}if(h==1){this.$sortModal.find("#delete").attr("disabled","disabled")}}})(jQuery);