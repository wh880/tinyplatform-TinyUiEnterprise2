/*!
 * jquery.fn.drag
 * @author ydr.me
 * @version 1.2
 * 2014年7月2日17:27:42
 */
(function(g,a){var e=g.$,i=g.document,d=e(i),c=e(i.body),f="jquery-drag",b={handle:null,drag:null,axis:"xy",cursor:"move",min:null,max:null,zIndex:9999,ondragbefore:e.noop,ondragstart:e.noop,ondrag:e.noop,ondragend:e.noop};e.fn.drag=function(n){var o=e.type(n)==="string",m=[].slice.call(arguments,1),l=e.extend({},b),k,j;if(o&&o[0]!=="_"){if(!this.length){return}k=e(this[0]);j=k.data(f);if(!j){k.data(f,j=new h(k[0],l)._init())}return h.prototype[n]?h.prototype[n].apply(j,m):a}else{if(!o){l=e.extend(l,n)}}return this.each(function(){var q=this,p=e(q).data(f);if(!p){e(q).data(f,p=new h(q,l)._init())}})};e.fn.drag.defaults=b;function h(k,j){this.element=k;this.options=j}h.prototype={_init:function(){var l=this,k=l.options,j=e(l.element);l.$element=j;if(k.handle){j.on("mousedown taphold",k.handle,e.proxy(l._start,l))}else{j.on("mousedown taphold",e.proxy(l._start,l))}d.mousemove(e.proxy(l._move,l)).mouseup(e.proxy(l._end,l)).bind("touchmove",e.proxy(l._move,l)).bind("touchend",e.proxy(l._end,l)).bind("touchcancel",e.proxy(l._end,l));return l},_start:function(o){if(!this.is){o=o.originalEvent;o.preventDefault();var p=this,r=p.options,q=p.$element,j=r.handle?e(o.target).closest(r.handle):e(o.target),m=r.drag?j.closest(r.drag):q,k,n,l=o.touches?o.touches[0]:o;if(!q.has(m).length){m=q}p.$drag=m;r.ondragbefore.call(m[0],o,p);p.zIndex=m.css("z-index");p.cursor=c.css("cursor");p.$drag=m.css("z-index",r.zIndex);k=m.css("position");n=m.offset();if(k==="static"){m.css("position","relative")}else{if(k==="fixed"||k==="absolute"){m.css(m.position())}}p.pos={x:l.pageX,y:l.pageY,l:n.left,t:n.top};p.is=!0;if(p.options.cursor){c.css("cursor",r.cursor)}r.ondragstart.call(m[0],o,p)}},_move:function(r){if(this.is){r=r.originalEvent;r.preventDefault();var s=this,w=s.options,p=w.min,u=w.max,t=s.pos,l=s.$drag,o=l.parent(!0).offset(),n,m,j,q,v={},k=r.touches?r.touches[0]:r;if(~w.axis.indexOf("x")){v.left=k.pageX-t.x+t.l}if(~w.axis.indexOf("y")){v.top=k.pageY-t.y+t.t}if(p&&p.left!==a){if(v.left<(n=p.left+o.left)){v.left=n}}if(p&&p.top!==a){if(v.top<(m=p.top+o.top)){v.top=m}}if(u&&u.left!==a){if(v.left>(j=u.left+o.left)){v.left=j}}if(u&&u.top!==a&&v.top>u.top){if(v.top>(q=u.top+o.top)){v.top=q}}l.offset(v);w.ondrag.call(l[0],r,s)}},_end:function(l){if(this.is){var k=this,j=k.$drag;l.preventDefault();k.is=!1;if(k.options.cursor){c.css("cursor",k.cursor)}j.css("z-index",k.zIndex);k.options.ondragend.call(j[0],l,k)}},options:function(j,l){if(e.type(j)==="string"&&l===a){return this.options[j]}var k={};if(e.type(j)==="object"){k=j}else{k[j]=l}this.options=e.extend(this.options,k)}}})(this);function Tinymodal_alert(b,a){$(document.body).append('<div id="modal-alert" class="modal hide modal-alert"><div class="modal-alert-info">'+b+"</div></div>");$("#modal-alert").fadeIn();setTimeout("Tinymodal_alert_hide()",a)}function Tinymodal_alert_hide(){$("#modal-alert").fadeOut("normal",function(){$("#modal-alert").remove()})};