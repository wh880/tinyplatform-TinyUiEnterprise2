var JSGantt;if(!JSGantt){JSGantt={}}var vgantColor;var vTimeout=0;var vBenchTime=new Date().getTime();JSGantt.TaskItem=function(v,x,e,c,k,t,w,q,o,J,b,B,h,u){var F=v;var H=x;var l=new Date();var y=new Date();var m=k;var C=t;var G=w;var D=q;var z=o;var f=J;var a=b;var d=B;var g=h;var I=u;var n="";var E=0;var p=0;var A=1;var s,L,r,K;if(f!=1){l=JSGantt.parseDateStr(e,gantg.getDateInputFormat());y=JSGantt.parseDateStr(c,gantg.getDateInputFormat())}this.getID=function(){return F};this.getName=function(){return H};this.getStart=function(){return l};this.getEnd=function(){return y};this.getColor=function(){return m};this.getLink=function(){return C};this.getMile=function(){return G};this.getDepend=function(){if(g){return g}else{return null}};this.getCaption=function(){if(I){return I}else{return""}};this.getResource=function(){if(D){return D}else{return"&nbsp"}};this.getCompVal=function(){if(z){return z}else{return 0}};this.getCompStr=function(){if(z){return z+"%"}else{return""}};this.getDuration=function(M){if(G){n="-"}else{if(M=="hour"){tmpPer=Math.ceil((this.getEnd()-this.getStart())/(60*60*1000));if(tmpPer==1){n="1 小时"}else{n=tmpPer+" 小时"}}else{if(M=="minute"){tmpPer=Math.ceil((this.getEnd()-this.getStart())/(60*1000));if(tmpPer==1){n="1 分"}else{n=tmpPer+" 分"}}else{tmpPer=Math.ceil((this.getEnd()-this.getStart())/(24*60*60*1000)+1);if(tmpPer==1){n="1 天"}else{n=tmpPer+" 天"}}}}return(n)};this.getParent=function(){return a};this.getGroup=function(){return f};this.getOpen=function(){return d};this.getLevel=function(){return E};this.getNumKids=function(){return p};this.getStartX=function(){return s};this.getStartY=function(){return L};this.getEndX=function(){return r};this.getEndY=function(){return K};this.getVisible=function(){return A};this.setDepend=function(M){g=M};this.setStart=function(M){l=M};this.setEnd=function(M){y=M};this.setLevel=function(M){E=M};this.setNumKid=function(M){p=M};this.setCompVal=function(M){z=M};this.setStartX=function(M){s=M};this.setStartY=function(M){L=M};this.setEndX=function(M){r=M};this.setEndY=function(M){K=M};this.setOpen=function(M){d=M};this.setVisible=function(M){A=M}};JSGantt.GanttChart=function(o,k,f){var w=o;var d=k;var a=f;var s=1;var l=1;var r=1;var m=1;var p=1;var q="yy-mm-dd";var g="yyyy-mm-dd";var h=0;var n;var c=1;var b=new Array();var t=new Array("day","week","month","quarter");var e=new Array(1,1,1,2,2,2,3,3,3,4,4,4);var u=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var v=new Array("一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月");this.setFormatArr=function(){t=new Array();for(var x=0;x<arguments.length;x++){t[x]=arguments[x]}if(t.length>4){t.length=4}};this.setShowRes=function(x){s=x};this.clearList=function(){b=[]};this.setShowDur=function(x){l=x};this.setShowComp=function(x){r=x};this.setColor=function(x){vgantColor=x};this.setShowStartDate=function(x){m=x};this.setShowEndDate=function(x){p=x};this.setDateInputFormat=function(x){q=x};this.setDateDisplayFormat=function(x){g=x};this.setCaptionType=function(x){n=x};this.setFormat=function(x){a=x;this.Draw()};this.getShowRes=function(){return s};this.getShowDur=function(){return l};this.getShowComp=function(){return r};this.getShowStartDate=function(){return m};this.getShowEndDate=function(){return p};this.getDateInputFormat=function(){return q};this.getDateDisplayFormat=function(){return g};this.getCaptionType=function(){return n};this.CalcTaskXY=function(){var B=this.getList();var D;var A;var C,y,x,z;for(i=0;i<B.length;i++){vID=B[i].getID();D=document.getElementById("taskbar_"+vID);vBarDiv=document.getElementById("bardiv_"+vID);A=document.getElementById("childgrid_"+vID);if(vBarDiv){B[i].setStartX(vBarDiv.offsetLeft);B[i].setStartY(A.offsetTop+vBarDiv.offsetTop+6);B[i].setEndX(vBarDiv.offsetLeft+vBarDiv.offsetWidth);B[i].setEndY(A.offsetTop+vBarDiv.offsetTop+6)}}};this.AddTaskItem=function(x){b.push(x)};this.getList=function(){return b};this.clearDependencies=function(){var y=document.getElementById("rightside");var z;var x=c;for(i=1;i<x;i++){z=document.getElementById("line"+i);if(z){y.removeChild(z)}}c=1};this.sLine=function(z,B,x,A){vLeft=Math.min(z,x);vTop=Math.min(B,A);vWid=Math.abs(x-z)+1;vHgt=Math.abs(A-B)+1;vDoc=document.getElementById("rightside");var y=document.createElement("div");y.id="line"+c++;y.style.position="absolute";y.style.margin="0px";y.style.padding="0px";y.style.overflow="hidden";y.style.border="0px";y.style.zIndex=0;y.style.backgroundColor="red";y.style.left=vLeft+"px";y.style.top=vTop+"px";y.style.width=vWid+"px";y.style.height=vHgt+"px";y.style.visibility="visible";vDoc.appendChild(y)};this.dLine=function(A,E,z,D){var H=z-A;var G=D-E;var F=A;var C=E;var B=Math.max(Math.abs(H),Math.abs(G));H=H/B;G=G/B;for(i=0;i<=B;i++){vx=Math.round(F);vy=Math.round(C);this.sLine(vx,vy,vx,vy);F+=H;C+=G}};this.drawDependency=function(y,A,x,z){if(y+10<x){this.sLine(y,A,y+4,A);this.sLine(y+4,A,y+4,z);this.sLine(y+4,z,x,z);this.dLine(x,z,x-3,z-3);this.dLine(x,z,x-3,z+3);this.dLine(x-1,z,x-3,z-2);this.dLine(x-1,z,x-3,z+2)}else{this.sLine(y,A,y+4,A);this.sLine(y+4,A,y+4,z-10);this.sLine(y+4,z-10,x-8,z-10);this.sLine(x-8,z-10,x-8,z);this.sLine(x-8,z,x,z);this.dLine(x,z,x-3,z-3);this.dLine(x,z,x-3,z+3);this.dLine(x-1,z,x-3,z-2);this.dLine(x-1,z,x-3,z+2)}};this.DrawDependencies=function(){this.CalcTaskXY();this.clearDependencies();var B=this.getList();for(var A=0;A<B.length;A++){vDepend=B[A].getDepend();if(vDepend){var x=vDepend+"";var D=x.split(",");var C=D.length;for(var y=0;y<C;y++){var z=this.getArrayLocationByID(D[y]);if(B[z].getVisible()==1){this.drawDependency(B[z].getEndX(),B[z].getEndY(),B[A].getStartX()-1,B[A].getStartY())}}}}};this.getArrayLocationByID=function(y){var z=this.getList();for(var x=0;x<z.length;x++){if(z[x].getID()==y){return x}}};this.Draw=function(){var L=new Date();var U=new Date();var B=new Date();var I=new Date();var C=new Date();var M=0;var X=0;var F=0;var P=0;var x="";var z="";var R="";var O="";var G="";var E=0;var D=0;var S=0;var y=0;var H=0;var N="";var K=220;var J=70;var W=15+220+70+70+70+70+70;if(b.length>0){JSGantt.processRows(b,0,-1,1,1);U=JSGantt.getMinDate(b,a);L=JSGantt.getMaxDate(b,a);if(a=="day"){E=18;D=1}else{if(a=="week"){E=37;D=7}else{if(a=="month"){E=37;D=30}else{if(a=="quarter"){E=60;D=90}else{if(a=="hour"){E=18;D=1}else{if(a=="minute"){E=18;D=1}}}}}}y=(Date.parse(L)-Date.parse(U))/(24*60*60*1000);h=y/D;S=h*E+1;H=(E/D)+(1/D);x='<TABLE id=theTable cellSpacing=0 cellPadding=0 border=0><TBODY><TR><TD vAlign=top bgColor=#ffffff style="border-top:1px solid #efefef;border-bottom:1px solid #efefef">';if(s!=1){K+=J}if(l!=1){K+=J}if(r!=1){K+=J}if(m!=1){K+=J}if(p!=1){K+=J}z='<DIV class=ganttscroll id=leftside style="width:'+W+'px;border-top:0;border-bottom:0"><TABLE cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 17px">  <TD style="WIDTH: 15px; HEIGHT: 20px"></TD>  <TD style="WIDTH: '+K+'px; HEIGHT: 17px"><NOBR></NOBR></TD>';if(s==1){z+='  <TD style="WIDTH: '+J+'px; HEIGHT: 17px"></TD>'}if(l==1){z+='  <TD style="WIDTH: '+J+'px; HEIGHT: 17px"></TD>'}if(r==1){z+='  <TD style="WIDTH: '+J+'px; HEIGHT: 17px"></TD>'}if(m==1){z+='  <TD style="WIDTH: '+J+'px; HEIGHT: 17px"></TD>'}if(p==1){z+='  <TD style="WIDTH: '+J+'px; HEIGHT: 17px"></TD>'}z+='<TR style="HEIGHT: 20px">  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: 15px; HEIGHT: 20px"></TD>  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: '+K+'px; HEIGHT: 20px"><NOBR></NOBR></TD>';if(s==1){z+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>指派给</TD>'}if(l==1){z+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>时长</TD>'}if(r==1){z+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>进度%</TD>'}if(m==1){z+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>开始时间</TD>'}if(p==1){z+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>截止时间</TD>'}z+="</TR>";for(T=0;T<b.length;T++){if(b[T].getGroup()){vBGColor="f3f3f3";vRowType="group"}else{vBGColor="ffffff";vRowType="row"}P=b[T].getID();if(b[T].getVisible()==0){z+="<TR id=child_"+P+" bgcolor=#"+vBGColor+' style="display:none"  onMouseover=gantg.mouseOver(this,'+P+',"left","'+vRowType+'") onMouseout=gantg.mouseOut(this,'+P+',"left","'+vRowType+'")>'}else{z+="<TR id=child_"+P+" bgcolor=#"+vBGColor+" onMouseover=gantg.mouseOver(this,"+P+',"left","'+vRowType+'") onMouseout=gantg.mouseOut(this,'+P+',"left","'+vRowType+'")>'}z+='  <TD class=gdatehead style="WIDTH: 15px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: none">&nbsp;</TD>  <TD class=gname style="WIDTH: '+K+'px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px;" nowrap><NOBR><span style="color: #aaaaaa">';for(j=1;j<b[T].getLevel();j++){z+="&nbsp&nbsp&nbsp&nbsp"}z+="</span>";if(b[T].getGroup()){if(b[T].getOpen()==1){z+='<SPAN id="group_'+P+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+P+","+w+");"+w+'.DrawDependencies();">&ndash;</span><span style="color:#000000">&nbsp</SPAN>'}else{z+='<SPAN id="group_'+P+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+P+","+w+");"+w+'.DrawDependencies();">+</span><span style="color:#000000">&nbsp</SPAN>'}}else{z+='<span style="color: #000000; font-weight:bold; FONT-SIZE: 12px;">&nbsp&nbsp&nbsp</span>'}z+='<span onclick=JSGantt.taskLink("'+b[T].getLink()+'",300,200); style="cursor:pointer"> '+b[T].getName()+"</span></NOBR></TD>";if(s==1){z+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+b[T].getResource()+"</NOBR></TD>"}if(l==1){z+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+b[T].getDuration(a)+"</NOBR></TD>"}if(r==1){z+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+b[T].getCompStr()+"</NOBR></TD>"}if(m==1){z+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(b[T].getStart(),g)+"</NOBR></TD>"}if(p==1){z+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(b[T].getEnd(),g)+"</NOBR></TD>"}z+="</TR>"}z+='</TD></TR><TR><TD border=1 colspan=15 align=left style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 11px; BORDER-LEFT:none; height:40px">&nbsp;&nbsp;格式:';if(t.join().indexOf("minute")!=-1){if(a=="minute"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="minute" checked>分'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("minute",'+w+'); VALUE="minute">分'}}if(t.join().indexOf("hour")!=-1){if(a=="hour"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="hour" checked>小时'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("hour",'+w+'); VALUE="hour">小时'}}if(t.join().indexOf("day")!=-1){if(a=="day"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="day" checked>天'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("day",'+w+'); VALUE="day">天'}}if(t.join().indexOf("week")!=-1){if(a=="week"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="week" checked>周'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("week",'+w+') VALUE="week">周'}}if(t.join().indexOf("month")!=-1){if(a=="month"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="month" checked>月'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("month",'+w+') VALUE="month">月'}}if(t.join().indexOf("quarter")!=-1){if(a=="quarter"){z+='<INPUT TYPE=RADIO NAME="radFormat" VALUE="quarter" checked>季'}else{z+='<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("quarter",'+w+') VALUE="quarter">季'}}z+="</TD></TR></TBODY></TABLE></TD>";x+=z;R='<TD style="width: '+S+'px;border:1px solid #efefef" vAlign=top bgColor=#ffffff><DIV class=ganttscroll2 id=rightside style="width:'+($(d).width()-W)+'px"><TABLE style="width: '+S+'px;" cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 18px">';B.setFullYear(U.getFullYear(),U.getMonth(),U.getDate());B.setHours(0);B.setMinutes(0);while(Date.parse(B)<=Date.parse(L)){N=B.getFullYear()+"";N=N.substring(2,4);if(a=="minute"){R+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=60>';R+=JSGantt.formatDateStr(B,g)+" "+B.getHours()+":00 -"+B.getHours()+":59 </td>";B.setHours(B.getHours()+1)}if(a=="hour"){R+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=24>';R+=JSGantt.formatDateStr(B,g)+"</td>";B.setDate(B.getDate()+1)}if(a=="day"){R+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=7>'+JSGantt.formatDateStr(B,"yyyy-mm-dd")+" 至 ";B.setDate(B.getDate()+6);R+=JSGantt.formatDateStr(B,"yyyy-mm-dd").substring(5)+"</td>";B.setDate(B.getDate()+1)}else{if(a=="week"){R+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+E+"px>`"+N+"</td>";B.setDate(B.getDate()+7)}else{if(a=="month"){R+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+E+"px>`"+N+"</td>";B.setDate(B.getDate()+1);while(B.getDate()>1){B.setDate(B.getDate()+1)}}else{if(a=="quarter"){R+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+E+"px>`"+N+"</td>";B.setDate(B.getDate()+81);while(B.getDate()>1){B.setDate(B.getDate()+1)}}}}}}R+="</TR><TR>";B.setFullYear(U.getFullYear(),U.getMonth(),U.getDate());I.setFullYear(U.getFullYear(),U.getMonth(),U.getDate());F=0;while(Date.parse(B)<=Date.parse(L)){if(a=="minute"){if(B.getMinutes()==0){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">'+B.getMinutes()+"</div></td>";G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>';B.setMinutes(B.getMinutes()+1)}else{if(a=="hour"){if(B.getHours()==0){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">'+B.getHours()+"</div></td>";G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>';B.setHours(B.getHours()+1)}else{if(a=="day"){if(JSGantt.formatDateStr(C,"mm/dd/yyyy")==JSGantt.formatDateStr(B,"mm/dd/yyyy")){vWeekdayColor="ccccff";vWeekendColor="9999ff";vWeekdayGColor="bbbbff";vWeekendGColor="8888ff"}else{vWeekdayColor="ffffff";vWeekendColor="cfcfcf";vWeekdayGColor="f3f3f3";vWeekendGColor="c3c3c3"}if(B.getDay()%6==0){O+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekendColor+' align=center><div style="width: '+E+'px">'+B.getDate()+"</div></td>";G+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekendColor+' align=center><div style="width: '+E+'px">&nbsp</div></td>'}else{O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">'+B.getDate()+"</div></td>";if(JSGantt.formatDateStr(C,"mm/dd/yyyy")==JSGantt.formatDateStr(B,"mm/dd/yyyy")){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}B.setDate(B.getDate()+1)}else{if(a=="week"){I.setDate(I.getDate()+7);if(C>=B&&C<I){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(I<=L){O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+E+'px><div style="width: '+E+'px">'+(B.getMonth()+1)+"/"+B.getDate()+"</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}else{O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; bgcolor=#'+vWeekdayColor+' BORDER-RIGHT: #efefef 1px solid;" align=center width:'+E+'px><div style="width: '+E+'px">'+(B.getMonth()+1)+"/"+B.getDate()+"</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}B.setDate(B.getDate()+7)}else{if(a=="month"){I.setFullYear(B.getFullYear(),B.getMonth(),u[B.getMonth()]);if(C>=B&&C<I){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(I<=L){O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+E+'px><div style="width: '+E+'px">'+v[B.getMonth()].substr(0,3)+"</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}else{O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+E+'px><div style="width: '+E+'px">'+v[B.getMonth()].substr(0,3)+"</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}B.setDate(B.getDate()+1);while(B.getDate()>1){B.setDate(B.getDate()+1)}}else{if(a=="quarter"){I.setDate(I.getDate()+122);if(B.getMonth()==0||B.getMonth()==1||B.getMonth()==2){I.setFullYear(B.getFullYear(),2,31)}else{if(B.getMonth()==3||B.getMonth()==4||B.getMonth()==5){I.setFullYear(B.getFullYear(),5,30)}else{if(B.getMonth()==6||B.getMonth()==7||B.getMonth()==8){I.setFullYear(B.getFullYear(),8,30)}else{if(B.getMonth()==9||B.getMonth()==10||B.getMonth()==11){I.setFullYear(B.getFullYear(),11,31)}}}}if(C>=B&&C<I){vWeekdayColor="ccccff"}else{vWeekdayColor="ffffff"}if(I<=L){O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+E+'px><div style="width: '+E+'px">第'+e[B.getMonth()]+"季</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}else{O+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+E+'px><div style="width: '+E+'px">第'+e[B.getMonth()]+"季</div></td>";if(C>=B&&C<I){G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}else{G+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+E+'px">&nbsp&nbsp</div></td>'}}B.setDate(B.getDate()+81);while(B.getDate()>1){B.setDate(B.getDate()+1)}}}}}}}}R+=O+"</TR>";R+="</TBODY></TABLE>";for(T=0;T<b.length;T++){B.setFullYear(U.getFullYear(),U.getMonth(),U.getDate());vTaskStart=b[T].getStart();vTaskEnd=b[T].getEnd();F=0;P=b[T].getID();h=(b[T].getEnd()-b[T].getStart())/(24*60*60*1000)+1;if(a=="hour"){h=(b[T].getEnd()-b[T].getStart())/(60*1000)+1}else{if(a=="minute"){h=(b[T].getEnd()-b[T].getStart())/(60*1000)+1}}if(b[T].getVisible()==0){R+="<DIV id=childgrid_"+P+' style="position:relative; display:none;">'}else{R+="<DIV id=childgrid_"+P+' style="position:relative">'}if(b[T].getMile()){R+='<DIV><TABLE style="position:relative; top:0px; width: '+S+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+P+' class=yesdisplay style="HEIGHT: 20px" onMouseover=gantg.mouseOver(this,'+P+',"right","mile") onMouseout=gantg.mouseOut(this,'+P+',"right","mile")>'+G+"</TR></TABLE></DIV>";O=JSGantt.formatDateStr(vTaskStart,g);M=(Date.parse(b[T].getStart())-Date.parse(U))/(24*60*60*1000);X=1;R+="<div id=bardiv_"+P+' style="position:absolute; top:0px; left:'+Math.ceil((M*(H)+1))+'px; height: 18px; width:160px; overflow:hidden;">  <div id=taskbar_'+P+' title="'+b[T].getName()+": "+O+'" style="height: 16px; width:12px; overflow:hidden; cursor: pointer;" onclick=JSGantt.taskLink("'+b[T].getLink()+'",300,200);>';if(b[T].getCompVal()<100){R+="&loz;</div>"}else{R+="&diams;</div>"}if(gantg.getCaptionType()){vCaptionStr="";switch(gantg.getCaptionType()){case"Caption":vCaptionStr=b[T].getCaption();break;case"Resource":vCaptionStr=b[T].getResource();break;case"Duration":vCaptionStr=b[T].getDuration(a);break;case"Complete":vCaptionStr=b[T].getCompStr();break}R+='<div style="FONT-SIZE:12px; position:absolute; top:2px; width:120px; left:12px">'+vCaptionStr+"</div>"}R+="</div>"}else{O=JSGantt.formatDateStr(vTaskStart,g)+" - "+JSGantt.formatDateStr(vTaskEnd,g);if(a=="minute"){X=(Date.parse(b[T].getEnd())-Date.parse(b[T].getStart()))/(60*1000)+1/D;M=Math.ceil((Date.parse(b[T].getStart())-Date.parse(U))/(60*1000))}else{if(a=="hour"){X=(Date.parse(b[T].getEnd())-Date.parse(b[T].getStart()))/(60*60*1000)+1/D;M=(Date.parse(b[T].getStart())-Date.parse(U))/(60*60*1000)}else{X=(Date.parse(b[T].getEnd())-Date.parse(b[T].getStart()))/(24*60*60*1000)+1/D;M=Math.ceil((Date.parse(b[T].getStart())-Date.parse(U))/(24*60*60*1000));if(a="day"){var A=new Date();A.setTime(Date.parse(b[T].getStart()));if(A.getMinutes()>29){M+=0.5}}}}if(b[T].getGroup()){R+='<DIV><TABLE style="position:relative; top:0px; width: '+S+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+P+' class=yesdisplay style="HEIGHT: 20px" bgColor=#f3f3f3 onMouseover=gantg.mouseOver(this,'+P+',"right","group") onMouseout=gantg.mouseOut(this,'+P+',"right","group")>'+G+"</TR></TABLE></DIV>";R+="<div id=bardiv_"+P+' style="position:absolute; top:5px; left:'+Math.ceil(M*(H)+1)+"px; height: 7px; width:"+Math.ceil((X)*(H)-1)+'px"><div id=taskbar_'+P+' title="'+b[T].getName()+": "+O+'" class=gtask style="background-color:#000000; height: 7px; width:'+Math.ceil((X)*(H)-1)+'px;  cursor: pointer;opacity:0.9;"><div style="Z-INDEX: -4; float:left; background-color:#666666; height:3px; overflow: hidden; margin-top:1px; margin-left:1px; margin-right:1px; filter: alpha(opacity=80); opacity:0.8; width:'+b[T].getCompStr()+'; cursor: pointer;" onclick=JSGantt.taskLink("'+b[T].getLink()+'",300,200);></div></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#000000; height:1px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#000000; height:1px; overflow: hidden; width:1px;"></div>';if(gantg.getCaptionType()){vCaptionStr="";switch(gantg.getCaptionType()){case"Caption":vCaptionStr=b[T].getCaption();break;case"Resource":vCaptionStr=b[T].getResource();break;case"Duration":vCaptionStr=b[T].getDuration(a);break;case"Complete":vCaptionStr=b[T].getCompStr();break}R+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil((X)*(H)-1)+6)+'px">'+vCaptionStr+"</div>"}R+="</div>"}else{vDivStr='<DIV><TABLE style="position:relative; top:0px; width: '+S+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+P+' class=yesdisplay style="HEIGHT: 20px" bgColor=#ffffff onMouseover=gantg.mouseOver(this,'+P+',"right","row") onMouseout=gantg.mouseOut(this,'+P+',"right","row")>'+G+"</TR></TABLE></DIV>";R+=vDivStr;R+="<div id=bardiv_"+P+' style="position:absolute; top:4px; left:'+Math.ceil(M*(H)+1)+"px; height:18px; width:"+Math.ceil((X)*(H)-1)+'px"><div id=taskbar_'+P+' title="'+b[T].getName()+": "+O+'" class=gtask style="background-color:#'+b[T].getColor()+"; height: 13px; width:"+Math.ceil((X)*(H)-1)+'px; cursor: pointer;opacity:0.9;" onclick=JSGantt.taskLink("'+b[T].getLink()+'",300,200); ><div class=gcomplete style="Z-INDEX: -4; float:left; background-color:black; height:5px; overflow: auto; margin-top:4px; filter: alpha(opacity=40); opacity:0.4; width:'+b[T].getCompStr()+'; overflow:hidden"></div></div>';if(gantg.getCaptionType()){vCaptionStr="";switch(gantg.getCaptionType()){case"Caption":vCaptionStr=b[T].getCaption();break;case"Resource":vCaptionStr=b[T].getResource();break;case"Duration":vCaptionStr=b[T].getDuration(a);break;case"Complete":vCaptionStr=b[T].getCompStr();break}R+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil((X)*(H)-1)+6)+'px">'+vCaptionStr+"</div>"}R+="</div>"}}R+="</DIV>"}R+="</DIV>";var V="";for(var T=0,Q=vgantColor.length;T<Q;T++){V+="P"+T+'<span style="display:inline-block;padding:5px 10px;margin:0 10px 0 5px;background:#'+vgantColor[T]+'"> </span> '}R+="<div style='text-align:right;padding-right:10px'>"+V+"</div>";x+=R+"</TD></TR></TBODY></TABLE>";d.innerHTML=x}};this.mouseOver=function(A,z,x,y){if(x=="right"){vID="child_"+z}else{vID="childrow_"+z}$(A).css("background","#ffffaa");vRowObj=JSGantt.findObj(vID);if(vRowObj){$(vRowObj).css("background","#ffffaa")}};this.mouseOut=function(A,z,x,y){if(x=="right"){vID="child_"+z}else{vID="childrow_"+z}$(A).css("background","#ffffff");vRowObj=JSGantt.findObj(vID);if(vRowObj){if(y=="group"){$(A).css("background","#f3f3f3");$(vRowObj).css("background","#f3f3f3")}else{$(A).css("background","#ffffff");$(vRowObj).css("background","#ffffff")}}}};JSGantt.isIE=function(){if(typeof document.all!="undefined"){return true}else{return false}};JSGantt.processRows=function(c,q,n,d,b){var o=new Date();var e=new Date();var h=0;var l=0;var m=c;var a=d;var f=0;var k=0;var p=0;var g=b;for(f=0;f<c.length;f++){if(c[f].getParent()==q){g=b;c[f].setVisible(g);if(g==1&&c[f].getOpen()==0){g=0}c[f].setLevel(a);k++;if(c[f].getGroup()==1){JSGantt.processRows(m,c[f].getID(),f,a+1,g)}if(h==0||c[f].getStart()<o){o=c[f].getStart();h=1}if(l==0||c[f].getEnd()>e){e=c[f].getEnd();l=1}p+=c[f].getCompVal()}}if(n>=0){c[n].setStart(o);c[n].setEnd(e);c[n].setNumKid(k);c[n].setCompVal(Math.ceil(p/k))}};JSGantt.getMinDate=function getMinDate(c,b){var a=new Date();a.setFullYear(c[0].getStart().getFullYear(),c[0].getStart().getMonth(),c[0].getStart().getDate());for(i=0;i<c.length;i++){if(Date.parse(c[i].getStart())<Date.parse(a)){a.setFullYear(c[i].getStart().getFullYear(),c[i].getStart().getMonth(),c[i].getStart().getDate())}}if(b=="minute"){a.setHours(0);a.setMinutes(0)}else{if(b=="hour"){a.setHours(0);a.setMinutes(0)}else{if(b=="day"){a.setDate(a.getDate()-1);while(a.getDay()%7>0){a.setDate(a.getDate()-1)}}else{if(b=="week"){a.setDate(a.getDate()-7);while(a.getDay()%7>0){a.setDate(a.getDate()-1)}}else{if(b=="month"){while(a.getDate()>1){a.setDate(a.getDate()-1)}}else{if(b=="quarter"){if(a.getMonth()==0||a.getMonth()==1||a.getMonth()==2){a.setFullYear(a.getFullYear(),0,1)}else{if(a.getMonth()==3||a.getMonth()==4||a.getMonth()==5){a.setFullYear(a.getFullYear(),3,1)}else{if(a.getMonth()==6||a.getMonth()==7||a.getMonth()==8){a.setFullYear(a.getFullYear(),6,1)}else{if(a.getMonth()==9||a.getMonth()==10||a.getMonth()==11){a.setFullYear(a.getFullYear(),9,1)}}}}}}}}}}return(a)};JSGantt.getMaxDate=function(c,b){var a=new Date();a.setFullYear(c[0].getEnd().getFullYear(),c[0].getEnd().getMonth(),c[0].getEnd().getDate());for(i=0;i<c.length;i++){if(Date.parse(c[i].getEnd())>Date.parse(a)){a.setTime(Date.parse(c[i].getEnd()))}}if(b=="minute"){a.setHours(a.getHours()+1);a.setMinutes(59)}if(b=="hour"){a.setHours(a.getHours()+2)}if(b=="day"){a.setDate(a.getDate()+1);while(a.getDay()%6>0){a.setDate(a.getDate()+1)}}if(b=="week"){a.setDate(a.getDate()+11);while(a.getDay()%6>0){a.setDate(a.getDate()+1)}}if(b=="month"){while(a.getDay()>1){a.setDate(a.getDate()+1)}a.setDate(a.getDate()-1)}if(b=="quarter"){if(a.getMonth()==0||a.getMonth()==1||a.getMonth()==2){a.setFullYear(a.getFullYear(),2,31)}else{if(a.getMonth()==3||a.getMonth()==4||a.getMonth()==5){a.setFullYear(a.getFullYear(),5,30)}else{if(a.getMonth()==6||a.getMonth()==7||a.getMonth()==8){a.setFullYear(a.getFullYear(),8,30)}else{if(a.getMonth()==9||a.getMonth()==10||a.getMonth()==11){a.setFullYear(a.getFullYear(),11,31)}}}}}return(a)};JSGantt.findObj=function(b,a){var e,c,d;if(!a){a=document}if((e=b.indexOf("?"))>0&&parent.frames.length){a=parent.frames[b.substring(e+1)].document;b=b.substring(0,e)}if(!(d=a[b])&&a.all){d=a.all[b]}for(c=0;!d&&c<a.forms.length;c++){d=a.forms[c][b]}for(c=0;!d&&a.layers&&c<a.layers.length;c++){d=JSGantt.findObj(b,a.layers[c].document)}if(!d&&document.getElementById){d=document.getElementById(b)}return d};JSGantt.changeFormat=function(a,b){if(b){b.setFormat(a);b.DrawDependencies()}else{alert("Chart undefined")}};JSGantt.folder=function(a,b){var c=b.getList();for(i=0;i<c.length;i++){if(c[i].getID()==a){if(c[i].getOpen()==1){c[i].setOpen(0);JSGantt.hide(a,b);if(JSGantt.isIE()){JSGantt.findObj("group_"+a).innerText="+"}else{JSGantt.findObj("group_"+a).textContent="+"}}else{c[i].setOpen(1);JSGantt.show(a,1,b);if(JSGantt.isIE()){JSGantt.findObj("group_"+a).innerText="－"}else{JSGantt.findObj("group_"+a).textContent="－"}}}}};JSGantt.hide=function(b,d){var e=d.getList();var a=0;for(var c=0;c<e.length;c++){if(e[c].getParent()==b){a=e[c].getID();JSGantt.findObj("child_"+a).style.display="none";JSGantt.findObj("childgrid_"+a).style.display="none";e[c].setVisible(0);if(e[c].getGroup()==1){JSGantt.hide(a,d)}}}};JSGantt.show=function(b,f,d){var e=d.getList();var a=0;for(var c=0;c<e.length;c++){if(e[c].getParent()==b){a=e[c].getID();if(f==1){if(JSGantt.isIE()){if(JSGantt.findObj("group_"+b).innerText=="+"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}else{if(JSGantt.findObj("group_"+b).textContent=="+"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}}else{if(JSGantt.isIE()){if(JSGantt.findObj("group_"+b).innerText=="－"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}else{if(JSGantt.findObj("group_"+b).textContent=="－"){JSGantt.findObj("child_"+a).style.display="";JSGantt.findObj("childgrid_"+a).style.display="";e[c].setVisible(1)}}}if(e[c].getGroup()==1){JSGantt.show(a,0,d)}}}};JSGantt.taskLink=function(c,a,b){if(a){vWidth=a}else{vWidth=400}if(b){vHeight=b}else{vHeight=400}$("#ganttModalLink").attr("href",c);$("#ganttModalLink").trigger("click")};JSGantt.parseDateStr=function(a,d){var c=new Date();c.setTime(Date.parse(a));switch(d){case"mm/dd/yyyy":var b=a.split("/");c.setFullYear(parseInt(b[2],10),parseInt(b[0],10)-1,parseInt(b[1],10));break;case"dd/mm/yyyy":var b=a.split("/");c.setFullYear(parseInt(b[2],10),parseInt(b[1],10)-1,parseInt(b[0],10));break;case"yyyy-mm-dd":var b=a.split("-");c.setFullYear(parseInt(b[0],10),parseInt(b[1],10)-1,parseInt(b[1],10));break}return(c)};JSGantt.formatDateStr=function(b,c){vYear4Str=b.getFullYear()+"";vYear2Str=vYear4Str.substring(2,4);vMonthStr=(b.getMonth()+1)+"";vDayStr=b.getDate()+"";var a="";switch(c){case"mm/dd/yyyy":return(vMonthStr+"/"+vDayStr+"/"+vYear4Str);case"dd/mm/yyyy":return(vDayStr+"/"+vMonthStr+"/"+vYear4Str);case"yyyy-mm-dd":return(vYear4Str+"-"+vMonthStr+"-"+vDayStr);case"mm/dd/yy":return(vMonthStr+"/"+vDayStr+"/"+vYear2Str);case"dd/mm/yy":return(vDayStr+"/"+vMonthStr+"/"+vYear2Str);case"yy-mm-dd":return(vYear2Str+"-"+vMonthStr+"-"+vDayStr);case"mm/dd":return(vMonthStr+"/"+vDayStr);case"dd/mm":return(vDayStr+"/"+vMonthStr)}};JSGantt.parseXML=function(b,a){var d=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;try{xmlDoc=new ActiveXObject("Microsoft.XMLDOM")}catch(c){try{if(d==false){xmlDoc=document.implementation.createDocument("","",null)}}catch(c){alert(c.message);return}}if(d==false){xmlDoc.async=false;xmlDoc.load(b);JSGantt.AddXMLTask(a);xmlDoc=null;Task=null}else{JSGantt.ChromeLoadXML(b,a);ta=null}};JSGantt.AddXMLTask=function(a){Task=xmlDoc.getElementsByTagName("task");var d=xmlDoc.documentElement.childNodes.length;for(var c=0;c<d;c++){try{pID=Task[c].getElementsByTagName("pID")[0].childNodes[0].nodeValue}catch(b){pID=0}pID*=1;if(pID!=0){try{pName=Task[c].getElementsByTagName("pName")[0].childNodes[0].nodeValue}catch(b){pName="No Task Name"}try{pColor=Task[c].getElementsByTagName("pColor")[0].childNodes[0].nodeValue}catch(b){pColor="0000ff"}try{pParent=Task[c].getElementsByTagName("pParent")[0].childNodes[0].nodeValue}catch(b){pParent=0}pParent*=1;try{pStart=Task[c].getElementsByTagName("pStart")[0].childNodes[0].nodeValue}catch(b){pStart=""}try{pEnd=Task[c].getElementsByTagName("pEnd")[0].childNodes[0].nodeValue}catch(b){pEnd=""}try{pLink=Task[c].getElementsByTagName("pLink")[0].childNodes[0].nodeValue}catch(b){pLink=""}try{pMile=Task[c].getElementsByTagName("pMile")[0].childNodes[0].nodeValue}catch(b){pMile=0}pMile*=1;try{pRes=Task[c].getElementsByTagName("pRes")[0].childNodes[0].nodeValue}catch(b){pRes=""}try{pComp=Task[c].getElementsByTagName("pComp")[0].childNodes[0].nodeValue}catch(b){pComp=0}pComp*=1;try{pGroup=Task[c].getElementsByTagName("pGroup")[0].childNodes[0].nodeValue}catch(b){pGroup=0}pGroup*=1;try{pOpen=Task[c].getElementsByTagName("pOpen")[0].childNodes[0].nodeValue}catch(b){pOpen=1}pOpen*=1;try{pDepend=Task[c].getElementsByTagName("pDepend")[0].childNodes[0].nodeValue}catch(b){pDepend=0}if(pDepend.length==0){pDepend=""}try{pCaption=Task[c].getElementsByTagName("pCaption")[0].childNodes[0].nodeValue}catch(b){pCaption=""}a.AddTaskItem(new JSGantt.TaskItem(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption))}}};JSGantt.ChromeLoadXML=function(b,a){XMLLoader=new XMLHttpRequest();XMLLoader.onreadystatechange=function(){JSGantt.ChromeXMLParse(a)};XMLLoader.open("GET",b,false);XMLLoader.send(null)};JSGantt.ChromeXMLParse=function(p){if(XMLLoader.readyState==4){var o=XMLLoader.responseText.split(/<task>/gi);var q=o.length;for(var t=1;t<q;t++){Task=o[t].replace(/<[/]p/g,"<p");var h=Task.split(/<pid>/i);if(h.length>2){var k=h[1]}else{var k=0}k*=1;var h=Task.split(/<pName>/i);if(h.length>2){var g=h[1]}else{var g="No Task Name"}var h=Task.split(/<pstart>/i);if(h.length>2){var e=h[1]}else{var e=""}var h=Task.split(/<pEnd>/i);if(h.length>2){var c=h[1]}else{var c=""}var h=Task.split(/<pColor>/i);if(h.length>2){var s=h[1]}else{var s="0000ff"}var h=Task.split(/<pLink>/i);if(h.length>2){var r=h[1]}else{var r=""}var h=Task.split(/<pMile>/i);if(h.length>2){var f=h[1]}else{var f=0}f*=1;var h=Task.split(/<pRes>/i);if(h.length>2){var v=h[1]}else{var v=""}var h=Task.split(/<pComp>/i);if(h.length>2){var d=h[1]}else{var d=0}d*=1;var h=Task.split(/<pGroup>/i);if(h.length>2){var m=h[1]}else{var m=0}m*=1;var h=Task.split(/<pParent>/i);if(h.length>2){var b=h[1]}else{var b=0}b*=1;var h=Task.split(/<pOpen>/i);if(h.length>2){var u=h[1]}else{var u=1}u*=1;var h=Task.split(/<pDepend>/i);if(h.length>2){var a=h[1]}else{var a=""}if(a.length==0){a=""}var h=Task.split(/<pCaption>/i);if(h.length>2){var l=h[1]}else{var l=""}p.AddTaskItem(new JSGantt.TaskItem(k,g,e,c,s,r,f,v,d,m,b,u,a,l))}}};JSGantt.benchMark=function(a){var b=new Date().getTime();alert(a+": Elapsed time: "+((b-vBenchTime)/1000)+" seconds.");vBenchTime=new Date().getTime()};