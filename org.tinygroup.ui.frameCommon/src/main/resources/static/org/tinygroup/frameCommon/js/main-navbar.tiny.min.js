(function(){TinyAdmin.MainNavbar=function(){this._scroller=false;this._wheight=null;this.scroll_pos=0;return this};TinyAdmin.MainNavbar.prototype.init=function(){var a;this.$navbar=$("#main-navbar");this.$header=this.$navbar.find(".navbar-header");this.$toggle=this.$navbar.find(".navbar-toggle:first");this.$collapse=$("#main-navbar-collapse");this.$collapse_div=this.$collapse.find("> div");a=false;$(window).on("pa.screen.small pa.screen.tablet",(function(b){return function(){if(b.$navbar.css("position")==="fixed"){b._setupScroller()}return a=true}})(this)).on("pa.screen.desktop",(function(b){return function(){b._removeScroller();return a=false}})(this));return this.$navbar.on("click",".nav-icon-btn.dropdown > .dropdown-toggle",function(b){if(a){b.preventDefault();b.stopPropagation();document.location.href=$(this).attr("href");return false}})};TinyAdmin.MainNavbar.prototype._setupScroller=function(){if(this._scroller){return}this._scroller=true;this.$collapse_div.pixelSlimScroll({});this.$navbar.on("shown.bs.collapse.mn_collapse",$.proxy(((function(a){return function(){a._updateCollapseHeight();return a._watchWindowHeight()}})(this)),this)).on("hidden.bs.collapse.mn_collapse",$.proxy(((function(a){return function(){a._wheight=null;return a.$collapse_div.pixelSlimScroll({scrollTo:"0px"})}})(this)),this)).on("shown.bs.dropdown.mn_collapse",$.proxy(this._updateCollapseHeight,this)).on("hidden.bs.dropdown.mn_collapse",$.proxy(this._updateCollapseHeight,this));return this._updateCollapseHeight()};TinyAdmin.MainNavbar.prototype._removeScroller=function(){if(!this._scroller){return}this._wheight=null;this._scroller=false;this.$collapse_div.pixelSlimScroll({destroy:"destroy"});this.$navbar.off("shown.bs.collapse.mn_collapse");this.$navbar.off("hidden.bs.collapse.mn_collapse");this.$navbar.off("shown.bs.dropdown.mn_collapse");this.$navbar.off("hidden.bs.dropdown.mn_collapse");return this.$collapse.attr("style","")};TinyAdmin.MainNavbar.prototype._updateCollapseHeight=function(){var c,b,a;if(!this._scroller){return}a=$(window).innerHeight();c=this.$header.outerHeight();b=this.$collapse_div.scrollTop();if((c+this.$collapse_div.css({"max-height":"none"}).outerHeight())>a){this.$collapse_div.css({"max-height":a-c})}else{this.$collapse_div.css({"max-height":"none"})}return this.$collapse_div.pixelSlimScroll({scrollTo:b+"px"})};TinyAdmin.MainNavbar.prototype._watchWindowHeight=function(){var a;this._wheight=$(window).innerHeight();a=(function(b){return function(){if(b._wheight===null){return}if(b._wheight!==$(window).innerHeight()){b._updateCollapseHeight()}b._wheight=$(window).innerHeight();return setTimeout(a,100)}})(this);return window.setTimeout(a,100)};TinyAdmin.MainNavbar.Constructor=TinyAdmin.MainNavbar;TinyAdmin.addInitializer(function(){return TinyAdmin.initPlugin("main_navbar",new TinyAdmin.MainNavbar)})}).call(this);