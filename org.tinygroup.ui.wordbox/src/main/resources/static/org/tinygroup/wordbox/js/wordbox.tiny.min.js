(function(b,c){function a(f,d){var e={isLead:false,leadWord:null,words:null,borderWidth:1,colors:["#49B4E0","#FCBDA2","#EBADBD","#D5C2AF","#C0BDE5","#CBCC7F","#FFDA7F","#8dd0c3","#bbbfc6","#a4d9ef","#bbdb98"],isFixedWidth:true,width:1000,height:200};this.options=c.extend(false,e,d);this.$wrapper=c(f);if(!this.$wrapper||this.options.words.length<1){return false}this._create();this._bindListener();return this}a.prototype={words:[],colors:[],colorPos:0,_create:function(){if(this.options.isLead&&this.options.leadWord){this.words=[this.options.leadWord].concat(this._randArray(this.options.words))}else{this.words=this._randArray(this.options.words)}if(this.options.isFixedWidth){this.$wrapper.width(this.options.width);this.$wrapper.height(this.options.height)}else{this.$wrapper.width(this.$wrapper.parent().width());this.$wrapper.height(this.$wrapper.parent().height())}this.fillRect(this.$wrapper,0,0,this.$wrapper.width(),this.$wrapper.height(),this.words)},fillRect:function(e,h,m,f,o,l){var g=l.length,k=f/o,d=this._randRange(1,2,0.5),q=Math.round(g*d[0]),p=g-q;if(g===1){this._createBox(e,h,m,f,o,l[0],this._getNextColor());return}if(q===0){q=1}else{if(p===0){q--}}if(k>=2.5){var i=Math.round(f*d[0]),j=f-i;this.fillRect(e,h,m,i,o,l.slice(0,q));this.fillRect(e,h+i,m,j,o,l.slice(q))}else{var n=Math.round(o*d[0]);this.fillRect(e,h,m,f,n,l.slice(0,q));this.fillRect(e,h,m+n,f,o-n,l.slice(q))}},_createBox:function(d,g,j,f,m,e,h){var k=m,n=0,l=this._getWordsWidth(e.title);if(l>f){var o=Math.ceil(l/f);k=parseInt(this.$wrapper.css("font-size"));n=Math.max(0,(m-o*k)/2);m-=n}var i='<div class="word-box-list" style="width:'+f+"px;height:"+m+"px;line-height:"+k+"px;top:"+j+"px;left:"+g+"px;background-color:"+h+";"+(n?("padding-top:"+n+"px;"):"")+'"><a href="'+e.url+'" >'+e.title+"</a></div>";c(d).append(i)},_randRange:function(j,g,f){var e=j/g,h=e*(1-f),d=e*(1+f),i=Math.random()*(d-h)+h;if(g===1){return[j]}return[i].concat(this._randRange(j-i,g-1,f))},_getNextColor:function(){var d=this.options.colors[this.colorPos%this.options.colors.length];this.colorPos++;return d},_getWordsWidth:function(d){if(c("#get_ww").size()<1){c('<div id="get_ww" style="display:block;visibility:hidden;font-size:'+this.$wrapper.css("font-size")+'px"><span></span></div>').appendTo("body")}c("#get_ww span").html(d);return c("#get_ww span").width()},_randArray:function(k){var j=k.slice(),e=[],h;for(var g=0,d=k.length;g<d;g++){h=Math.floor(Math.random()*j.length);var f=j[0];j[0]=j[h];j[h]=f;e.push(j[0]);j=j.slice(1)}return e},_bindListener:function(){if(!this.options.isFixedWidth){var e=this,d=null;c(b).bind("resize",function(){if(d){clearTimeout(b.timer);d=null}d=setTimeout(function(){if(e.$wrapper.width()!==e.$wrapper.parent().width()||e.$wrapper.height()!==e.$wrapper.parent().height()){e.$wrapper.width(e.$wrapper.parent().width());e.$wrapper.height(e.$wrapper.parent().height());e.$wrapper.empty();e.fillRect(e.$wrapper,0,0,e.$wrapper.width(),e.$wrapper.height(),e.words)}},800)})}}};b.WordBox=a;c.fn.wordbox=function(e){var d=new a(this,e);if(!d){return null}return c(this)}})(window,jQuery);