UE.plugins.macros=function(){var d=this,e="macros";d.commands[e]={execCommand:function(){var g=new UE.ui.Dialog({iframeUrl:this.options.UEDITOR_HOME_URL+"macro/macro.pagelet",name:e,editor:this,title:"宏控件",cssRules:"width:600px;height:270px;",buttons:[{className:"edui-okbutton",label:"确定",onclick:function(){g.close(true)}},{className:"edui-cancelbutton",label:"取消",onclick:function(){g.close(false)}}]});g.render();g.open()}};var a=new baidu.editor.ui.Popup({editor:this,content:"",className:"edui-bubble",_edittext:function(){baidu.editor.plugins[e].editdom=a.anchorEl;d.execCommand(e);this.hide()},_delete:function(){if(window.confirm("确认删除该控件吗？")){baidu.editor.dom.domUtils.remove(this.anchorEl,false)}this.hide()}});a.render();d.addListener("mouseover",function(i,g){g=g||window.event;var j=g.target||g.srcElement;var k=j.getAttribute("tinyplugins");if(/div/ig.test(j.tagName)&&k==e){var h=a.formatHtml('<nobr>宏控件: <span onclick=$$._edittext() class="edui-clickable">编辑</span>&nbsp;&nbsp;<span onclick=$$._delete() class="edui-clickable">删除</span></nobr>');if(h){a.getDom("content").innerHTML=h;a.anchorEl=j;a.showAnchor(a.anchorEl)}else{a.hide()}}});var f,c=0;function b(g){g=g||window.event;var j,h=g.target||g.srcElement;var i=$(h).closest("[tinyplugins]").get(0);if(typeof(i)!="undefined"){j=i.getAttribute("tinyplugins");if(j==e){baidu.editor.plugins[e].editdom=i;d.execCommand(e)}}}d.addListener("click",function(h,g){c++;if(c==2){b(g)}f=setTimeout(function(){c--},500)})};UE.ueAddonPlus=function(a){UE.registerUI("button_macros",function(c,d){c.registerCommand(d,{execCommand:function(){c.execCommand("macros")}});var b=new UE.ui.Button({name:d,title:"宏编辑器",cssRules:"background-position: -401px -40px;",onclick:function(){c.execCommand(d)}});return b},99999,[a])};