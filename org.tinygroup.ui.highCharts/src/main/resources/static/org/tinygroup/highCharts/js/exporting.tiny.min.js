(function(L){var w=L.Chart,h=L.addEvent,s=L.removeEvent,o=HighchartsAdapter.fireEvent,K=L.createElement,x=L.discardElement,d=L.css,I=L.merge,z=L.each,u=L.extend,f=L.splat,e=Math.max,J=document,i=window,c=L.isTouchDevice,b=L.Renderer.prototype.symbols,n=L.getOptions(),a;u(n.lang,{printChart:"打印图表",downloadPNG:"下载PNG图像",downloadJPEG:"下载JPEG图像",downloadPDF:"下载PDF文档",downloadSVG:"SVG矢量图下载",contextButtonTitle:"图上下文菜单"});n.navigation={menuStyle:{border:"1px solid #A0A0A0",background:"#FFFFFF",padding:"5px 0"},menuItemStyle:{padding:"0 10px",background:"none",color:"#303030",fontSize:c?"14px":"11px"},menuItemHoverStyle:{background:"#4572A5",color:"#FFFFFF"},buttonOptions:{symbolFill:"#E0E0E0",symbolSize:14,symbolStroke:"#666",symbolStrokeWidth:3,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,theme:{fill:"white",stroke:"none"},verticalAlign:"top",width:24}};n.exporting={type:"image/png",url:"http://export.highcharts.com/",buttons:{contextButton:{menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart",onclick:function(){this.print()}},{separator:!0},{textKey:"downloadPNG",onclick:function(){this.exportChart()}},{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}]}}};L.post=function(g,j,k){var l,g=K("form",I({method:"post",action:g,enctype:"multipart/form-data"},k),{display:"none"},J.body);for(l in j){K("input",{type:"hidden",name:l,value:j[l]},null,g)}g.submit();x(g)};u(w.prototype,{sanitizeSVG:function(g){return g.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g,"\u00a0").replace(/&shy;/g,"\u00ad").replace(/<IMG /g,"<image ").replace(/<(\/?)TITLE>/g,"<$1title>").replace(/height=([^" ]+)/g,'height="$1"').replace(/width=([^" ]+)/g,'width="$1"').replace(/hc-svg-href="([^"]+)">/g,'xlink:href="$1"/>').replace(/ id=([^" >]+)/g,' id="$1"').replace(/class=([^" >]+)/g,'class="$1"').replace(/ transform /g," ").replace(/:(path|rect)/g,"$1").replace(/style="([^"]+)"/g,function(j){return j.toLowerCase()})},getChartHTML:function(){return this.container.innerHTML},getSVG:function(q){var r=this,k,m,j,p,g,l=I(r.options,q),t=l.exporting.allowHTML;if(!J.createElementNS){J.createElementNS=function(y,v){return J.createElement(v)}}m=K("div",null,{position:"absolute",top:"-9999em",width:r.chartWidth+"px",height:r.chartHeight+"px"},J.body);j=r.renderTo.style.width;g=r.renderTo.style.height;j=l.exporting.sourceWidth||l.chart.width||/px$/.test(j)&&parseInt(j,10)||600;g=l.exporting.sourceHeight||l.chart.height||/px$/.test(g)&&parseInt(g,10)||400;u(l.chart,{animation:!1,renderTo:m,forExport:!t,width:j,height:g});l.exporting.enabled=!1;delete l.data;l.series=[];z(r.series,function(v){p=I(v.options,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:v.visible});p.isInternal||l.series.push(p)});q&&z(["xAxis","yAxis"],function(v){z(f(q[v]),function(y,A){l[v][A]=I(l[v][A],y)})});k=new L.Chart(l,r.callback);z(["xAxis","yAxis"],function(v){z(r[v],function(y,D){var C=k[v][D],B=y.getExtremes(),A=B.userMin,B=B.userMax;C&&(A!==void 0||B!==void 0)&&C.setExtremes(A,B,!0,!1)})});j=k.getChartHTML();l=null;k.destroy();x(m);if(t&&(m=j.match(/<\/svg>(.*?$)/))){m='<foreignObject x="0" y="0 width="200" height="200"><body xmlns="http://www.w3.org/1999/xhtml">'+m[1]+"</body></foreignObject>",j=j.replace("</svg>",m+"</svg>")}j=this.sanitizeSVG(j);return j=j.replace(/(url\(#highcharts-[0-9]+)&quot;/g,"$1").replace(/&quot;/g,"'")},getSVGForExport:function(g,j){var k=this.options.exporting;return this.getSVG(I({chart:{borderRadius:0}},k.chartOptions,j,{exporting:{sourceWidth:g&&g.sourceWidth||k.sourceWidth,sourceHeight:g&&g.sourceHeight||k.sourceHeight}}))},exportChart:function(g,j){var k=this.getSVGForExport(g,j),g=I(this.options.exporting,g);L.post(g.url,{filename:g.filename||"chart",type:g.type,width:g.width||0,scale:g.scale||2,svg:k},g.formAttributes)},print:function(){var j=this,k=j.container,p=[],q=k.parentNode,m=J.body,l=m.childNodes;if(!j.isPrinting){j.isPrinting=!0,o(j,"beforePrint"),z(l,function(r,g){if(r.nodeType===1){p[g]=r.style.display,r.style.display="none"}}),m.appendChild(k),i.focus(),i.print(),setTimeout(function(){q.appendChild(k);z(l,function(r,g){if(r.nodeType===1){r.style.display=p[g]}});j.isPrinting=!1;o(j,"afterPrint")},1000)}},contextMenu:function(P,Q,M,O,H,G,F){var N=this,t=N.options.navigation,C=t.menuItemStyle,B=N.chartWidth,A=N.chartHeight,D="cache-"+P,E=N[D],q=e(H,G),m,j,y,v=function(g){N.pointer.inClass(g.target,P)||j()};if(!E){N[D]=E=K("div",{className:P},{position:"absolute",zIndex:1000,padding:q+"px"},N.container),m=K("div",null,u({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},t.menuStyle),E),j=function(){d(E,{display:"none"});F&&F.setState(0);N.openMenu=!1},h(E,"mouseleave",function(){y=setTimeout(j,500)}),h(E,"mouseenter",function(){clearTimeout(y)}),h(document,"mouseup",v),h(N,"destroy",function(){s(document,"mouseup",v)}),z(Q,function(k){if(k){var g=k.separator?K("hr",null,null,m):K("div",{onmouseover:function(){d(this,t.menuItemHoverStyle)},onmouseout:function(){d(this,C)},onclick:function(l){l.stopPropagation();j();k.onclick&&k.onclick.apply(N,arguments)},innerHTML:k.text||N.options.lang[k.textKey]},u({cursor:"pointer"},C),m);N.exportDivElements.push(g)}}),N.exportDivElements.push(m,E),N.exportMenuWidth=E.offsetWidth,N.exportMenuHeight=E.offsetHeight}Q={display:"block"};M+N.exportMenuWidth>B?Q.right=B-M-H-q+"px":Q.left=M-q+"px";O+G+N.exportMenuHeight>A&&F.alignOptions.verticalAlign!=="top"?Q.bottom=A-O-q+"px":Q.top=O+G-q+"px";d(E,Q);N.openMenu=!0},addButton:function(F){var G=this,C=G.renderer,E=I(G.options.navigation.buttonOptions,F),B=E.onclick,t=E.menuItems,A,D,r={stroke:E.symbolStroke,fill:E.symbolFill},v=E.symbolSize||12;if(!G.btnCount){G.btnCount=0}if(!G.exportDivElements){G.exportDivElements=[],G.exportSVGElements=[]}if(E.enabled!==!1){var q=E.theme,l=q.states,g=l&&l.hover,l=l&&l.select,y;delete q.states;B?y=function(j){j.stopPropagation();B.call(G,j)}:t&&(y=function(){G.contextMenu(D.menuClassName,t,D.translateX,D.translateY,D.width,D.height,D);D.setState(2)});E.text&&E.symbol?q.paddingLeft=L.pick(q.paddingLeft,25):E.text||u(q,{width:E.width,height:E.height,padding:0});D=C.button(E.text,0,0,y,q,g,l).attr({title:G.options.lang[E._titleKey],"stroke-linecap":"round"});D.menuClassName=F.menuClassName||"highcharts-menu-"+G.btnCount++;E.symbol&&(A=C.symbol(E.symbol,E.symbolX-v/2,E.symbolY-v/2,v,v).attr(u(r,{"stroke-width":E.symbolStrokeWidth||1,zIndex:1})).add(D));D.add().align(u(E,{width:D.width,x:L.pick(E.x,a)}),!0,"spacingBox");a+=(D.width+E.buttonSpacing)*(E.align==="right"?-1:1);G.exportSVGElements.push(D,A)}},destroyExport:function(g){var g=g.target,j,k;for(j=0;j<g.exportSVGElements.length;j++){if(k=g.exportSVGElements[j]){k.onclick=k.ontouchstart=null,g.exportSVGElements[j]=k.destroy()}}for(j=0;j<g.exportDivElements.length;j++){k=g.exportDivElements[j],s(k,"mouseleave"),g.exportDivElements[j]=k.onmouseout=k.onmouseover=k.ontouchstart=k.onclick=null,x(k)}}});b.menu=function(g,j,k,l){return["M",g,j+2.5,"L",g+k,j+2.5,"M",g,j+l/2+0.5,"L",g+k,j+l/2+0.5,"M",g,j+l-1.5,"L",g+k,j+l-1.5]};w.prototype.callbacks.push(function(g){var j,k=g.options.exporting,l=k.buttons;a=0;if(k.enabled!==!1){for(j in l){g.addButton(l[j])}h(g,"destroy",g.destroyExport)}})})(Highcharts);